{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "Compile target install",
			"type": "shell",
			"linux": {
				"command": [
					"cd ../ &&",
					"export CC=$(brew --prefix llvm)/bin/clang && export CXX=$(brew --prefix llvm)/bin/clang++ &&",
					"$(brew --prefix cmake)/bin/cmake --build pharo-vm-build --target install &&",
					"rm -rf build/ pharo-vm-build/build/dist/lib/{libss*,libcairo.so*,libgit2.*,libharfbuzz.so*,libfontconfig.so*,libbz2.so.1*,libcrypto.so*,libexpat.so*,libfreetype.so*,libpixman-1.so*,libpng*} &&",
					"mkdir -p pharo-vm-build/build/dist/share &&",
					"cp -r /usr/local/share/tree-sitter pharo-vm-build/build/dist/share/"
				]
			},
			"osx": {
				"command": [
					"cd ../ &&",
					"export CC=$(brew --prefix llvm)/bin/clang && export CXX=$(brew --prefix llvm)/bin/clang++ &&",
					"$(brew --prefix cmake)/bin/cmake --build pharo-vm-build --target install &&",
					"rm -rf build/ pharo-vm-build/build/dist/Pharo.app/Contents/MacOS/Plugins/{libss*,libcairo*,libcrypto*,libgit2.*,libharfbuzz*,libfontconfig*,libfreetype*,libpixman*,libpng*} &&",
					"mkdir -p pharo-vm-build/build/dist/share &&",
					"cp -r /usr/local/share/tree-sitter pharo-vm-build/build/dist/share/"
				]
			},
			"windows": {
				"command": "C:\\msys64\\usr\\bin\\bash.exe scripts\\cygwin-build.sh"
			},
			"group": "build",
			"presentation": {
				"reveal": "always",
				"panel": "new"
			}
		},
		{
			"label": "Prepare compilation",
			"type": "shell",
			"linux": {
				"command": [
					"cd ../ && ",
					// "rm -rf pharo-vm-c-src && mkdir -p pharo-vm-c-src && cd pharo-vm-c-src &&",
					// "wget https://files.pharo.org/vm/pharo-spur64-headless/Linux-x86_64/source/PharoVM-10.2.1-d1bfe9e-Linux-x86_64-c-src.zip  --no-verbose &&",
					// "unzip PharoVM-10.2.1-d1bfe9e-Linux-x86_64-c-src.zip && cd ../ &&",
					"export CC=$(brew --prefix llvm)/bin/clang && export CXX=$(brew --prefix llvm)/bin/clang++ &&",
					"$(brew --prefix cmake)/bin/cmake -S pharo-vm -B pharo-vm-build -DPHARO_DEPENDENCIES_PREFER_DOWNLOAD_BINARIES=TRUE -DBUILD_IS_RELEASE=ON -DICEBERG_DEFAULT_REMOTE=httpsUrl -DGENERATE_SOURCES=TRUE &&", //#-DGENERATED_SOURCE_DIR=../pharo-vm-c-src/pharo-vm/
					// "cp $(brew --prefix sdl2)/lib/libSDL2.so pharo-vm-build/SDL2-2.24.1-src/ && cp $(brew --prefix sdl2)/lib/libSDL2-2.0.so.0 pharo-vm-build/SDL2-2.24.1-src/ && cp $(brew --prefix sdl2)/lib/libSDL2-2.0.so.0 pharo-vm-build/SDL2-2.24.1-src/libSDL2-2.0.so.0.2400.1",
					"echo 'Done'"
				]
			},
			"osx": {
				"command": [
					"cd ../ &&",
					// "rm -rf pharo-vm-c-src && mkdir -p pharo-vm-c-src && cd pharo-vm-c-src &&",
					// "wget https://files.pharo.org/vm/pharo-spur64-headless/Darwin-x86_64/source/PharoVM-10.2.1-d1bfe9ec-Darwin-x86_64-c-src.zip  --no-verbose &&",
					// "unzip PharoVM-10.2.1-d1bfe9ec-Darwin-x86_64-c-src.zip && cd ../ &&",
					"export CC=$(brew --prefix llvm)/bin/clang && export CXX=$(brew --prefix llvm)/bin/clang++ &&",
					"$(brew --prefix cmake)/bin/cmake -S pharo-vm -B pharo-vm-build -DALWAYS_INTERACTIVE=TRUE -DPHARO_DEPENDENCIES_PREFER_DOWNLOAD_BINARIES=TRUE -DICEBERG_DEFAULT_REMOTE=httpsUrl -DGENERATE_SOURCES=TRUE &&",  // -DGENERATED_SOURCE_DIR=../pharo-vm-c-src/pharo-vm/
					// "cp $(brew --prefix sdl2)/lib/libSDL2-2.0.0.dylib pharo-vm-build/SDL2-2.24.1-src/ && cp $(brew --prefix sdl2)/lib/libSDL2-2.0.0.dylib pharo-vm-build/SDL2-2.24.1-src/libSDL2.dylib",
					"echo 'Done'"
				]
			},
			"windows": {
				"command": "C:\\msys64\\usr\\bin\\bash.exe scripts\\cygwin-prepareCompilation.sh"
			},
			"group": "build",
			"presentation": {
				"reveal": "always",
				"panel": "new"
			}
		},
		{
			"label": "(Hard) Clean build",
			"type": "shell",
			"linux": {
				"command": "rm -rf ../pharo-vm-build ../pharo-vm-c-src"
			},
			"osx": {
				"command": "rm -rf ../pharo-vm-build ../pharo-vm-c-src"
			},
			"windows": {
				"command": "C:\\msys64\\usr\\bin\\bash.exe scripts\\cygwin-hardClean.sh"
			},
			"group": "build",
			"presentation": {
				"reveal": "always",
				"panel": "new"
			}
		}
	]
}